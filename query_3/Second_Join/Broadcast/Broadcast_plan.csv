Description,Details
Execution Plan,"== Parsed Logical Plan ==
Join Inner,  **org.apache.spark.sql.sedona_sql.expressions.ST_Within**
:- Project [DR_NO#72139, LAT#72165, LON#72166,  **org.apache.spark.sql.sedona_sql.expressions.ST_Point**   AS geom#72199]
:  +- Project [DR_NO#72139, LAT#72165, LON#72166]
:     +- Filter (NOT (cast(LAT#72165 as int) = 0) AND NOT (cast(LON#72166 as int) = 0))
:        +- Relation [DR_NO#72139,Date Rptd#72140,DATE OCC#72141,TIME OCC#72142,AREA #72143,AREA NAME#72144,Rpt Dist No#72145,Part 1-2#72146,Crm Cd#72147,Crm Cd Desc#72148,Mocodes#72149,Vict Age#72150,Vict Sex#72151,Vict Descent#72152,Premis Cd#72153,Premis Desc#72154,Weapon Used Cd#72155,Weapon Desc#72156,Status#72157,Status Desc#72158,Crm Cd 1#72159,Crm Cd 2#72160,Crm Cd 3#72161,Crm Cd 4#72162,... 4 more fields] csv
+- ResolvedHint (strategy=broadcast)
   +- Filter (((HOUSING10#71854L >= cast(0 as bigint)) AND (POP_2010#71857L >= cast(0 as bigint))) AND (CITY#71846 = Los Angeles))
      +- Project [properties#71836.BG10 AS BG10#71841, properties#71836.BG10FIP10 AS BG10FIP10#71842, properties#71836.BG12 AS BG12#71843, properties#71836.CB10 AS CB10#71844, properties#71836.CEN_FIP13 AS CEN_FIP13#71845, properties#71836.CITY AS CITY#71846, properties#71836.CITYCOM AS CITYCOM#71847, properties#71836.COMM AS COMM#71848, properties#71836.CT10 AS CT10#71849, properties#71836.CT12 AS CT12#71850, properties#71836.CTCB10 AS CTCB10#71851, properties#71836.HD_2012 AS HD_2012#71852L, properties#71836.HD_NAME AS HD_NAME#71853, properties#71836.HOUSING10 AS HOUSING10#71854L, properties#71836.LA_FIP10 AS LA_FIP10#71855, properties#71836.OBJECTID AS OBJECTID#71856L, properties#71836.POP_2010 AS POP_2010#71857L, properties#71836.PUMA10 AS PUMA10#71858, properties#71836.SPA_2012 AS SPA_2012#71859L, properties#71836.SPA_NAME AS SPA_NAME#71860, properties#71836.SUP_DIST AS SUP_DIST#71861, properties#71836.SUP_LABEL AS SUP_LABEL#71862, properties#71836.ShapeSTArea AS ShapeSTArea#71863, properties#71836.ShapeSTLength AS ShapeSTLength#71864, ... 2 more fields]
         +- Project [features#71832.geometry AS geometry#71835, features#71832.properties AS properties#71836, features#71832.type AS type#71837]
            +- Project [features#71832]
               +- Generate explode(features#71824), false, [features#71832]
                  +- Relation [crs#71823,features#71824,name#71825,type#71826] geojson

== Analyzed Logical Plan ==
DR_NO: string, LAT: string, LON: string, geom: geometry, BG10: string, BG10FIP10: string, BG12: string, CB10: string, CEN_FIP13: string, CITY: string, CITYCOM: string, COMM: string, CT10: string, CT12: string, CTCB10: string, HD_2012: bigint, HD_NAME: string, HOUSING10: bigint, LA_FIP10: string, OBJECTID: bigint, POP_2010: bigint, PUMA10: string, SPA_2012: bigint, SPA_NAME: string, ... 6 more fields
Join Inner,  **org.apache.spark.sql.sedona_sql.expressions.ST_Within**
:- Project [DR_NO#72139, LAT#72165, LON#72166,  **org.apache.spark.sql.sedona_sql.expressions.ST_Point**   AS geom#72199]
:  +- Project [DR_NO#72139, LAT#72165, LON#72166]
:     +- Filter (NOT (cast(LAT#72165 as int) = 0) AND NOT (cast(LON#72166 as int) = 0))
:        +- Relation [DR_NO#72139,Date Rptd#72140,DATE OCC#72141,TIME OCC#72142,AREA #72143,AREA NAME#72144,Rpt Dist No#72145,Part 1-2#72146,Crm Cd#72147,Crm Cd Desc#72148,Mocodes#72149,Vict Age#72150,Vict Sex#72151,Vict Descent#72152,Premis Cd#72153,Premis Desc#72154,Weapon Used Cd#72155,Weapon Desc#72156,Status#72157,Status Desc#72158,Crm Cd 1#72159,Crm Cd 2#72160,Crm Cd 3#72161,Crm Cd 4#72162,... 4 more fields] csv
+- ResolvedHint (strategy=broadcast)
   +- Filter (((HOUSING10#71854L >= cast(0 as bigint)) AND (POP_2010#71857L >= cast(0 as bigint))) AND (CITY#71846 = Los Angeles))
      +- Project [properties#71836.BG10 AS BG10#71841, properties#71836.BG10FIP10 AS BG10FIP10#71842, properties#71836.BG12 AS BG12#71843, properties#71836.CB10 AS CB10#71844, properties#71836.CEN_FIP13 AS CEN_FIP13#71845, properties#71836.CITY AS CITY#71846, properties#71836.CITYCOM AS CITYCOM#71847, properties#71836.COMM AS COMM#71848, properties#71836.CT10 AS CT10#71849, properties#71836.CT12 AS CT12#71850, properties#71836.CTCB10 AS CTCB10#71851, properties#71836.HD_2012 AS HD_2012#71852L, properties#71836.HD_NAME AS HD_NAME#71853, properties#71836.HOUSING10 AS HOUSING10#71854L, properties#71836.LA_FIP10 AS LA_FIP10#71855, properties#71836.OBJECTID AS OBJECTID#71856L, properties#71836.POP_2010 AS POP_2010#71857L, properties#71836.PUMA10 AS PUMA10#71858, properties#71836.SPA_2012 AS SPA_2012#71859L, properties#71836.SPA_NAME AS SPA_NAME#71860, properties#71836.SUP_DIST AS SUP_DIST#71861, properties#71836.SUP_LABEL AS SUP_LABEL#71862, properties#71836.ShapeSTArea AS ShapeSTArea#71863, properties#71836.ShapeSTLength AS ShapeSTLength#71864, ... 2 more fields]
         +- Project [features#71832.geometry AS geometry#71835, features#71832.properties AS properties#71836, features#71832.type AS type#71837]
            +- Project [features#71832]
               +- Generate explode(features#71824), false, [features#71832]
                  +- Relation [crs#71823,features#71824,name#71825,type#71826] geojson

== Optimized Logical Plan ==
Join Inner,  **org.apache.spark.sql.sedona_sql.expressions.ST_Within**  , rightHint=(strategy=broadcast)
:- Project [DR_NO#72139, LAT#72165, LON#72166,  **org.apache.spark.sql.sedona_sql.expressions.ST_Point**   AS geom#72199]
:  +- Filter (((isnotnull(LAT#72165) AND isnotnull(LON#72166)) AND (NOT (cast(LAT#72165 as int) = 0) AND NOT (cast(LON#72166 as int) = 0))) AND isnotnull( **org.apache.spark.sql.sedona_sql.expressions.ST_Point**  ))
:     +- Relation [DR_NO#72139,Date Rptd#72140,DATE OCC#72141,TIME OCC#72142,AREA #72143,AREA NAME#72144,Rpt Dist No#72145,Part 1-2#72146,Crm Cd#72147,Crm Cd Desc#72148,Mocodes#72149,Vict Age#72150,Vict Sex#72151,Vict Descent#72152,Premis Cd#72153,Premis Desc#72154,Weapon Used Cd#72155,Weapon Desc#72156,Status#72157,Status Desc#72158,Crm Cd 1#72159,Crm Cd 2#72160,Crm Cd 3#72161,Crm Cd 4#72162,... 4 more fields] csv
+- Project [features#71832.properties.BG10 AS BG10#71841, features#71832.properties.BG10FIP10 AS BG10FIP10#71842, features#71832.properties.BG12 AS BG12#71843, features#71832.properties.CB10 AS CB10#71844, features#71832.properties.CEN_FIP13 AS CEN_FIP13#71845, features#71832.properties.CITY AS CITY#71846, features#71832.properties.CITYCOM AS CITYCOM#71847, features#71832.properties.COMM AS COMM#71848, features#71832.properties.CT10 AS CT10#71849, features#71832.properties.CT12 AS CT12#71850, features#71832.properties.CTCB10 AS CTCB10#71851, features#71832.properties.HD_2012 AS HD_2012#71852L, features#71832.properties.HD_NAME AS HD_NAME#71853, features#71832.properties.HOUSING10 AS HOUSING10#71854L, features#71832.properties.LA_FIP10 AS LA_FIP10#71855, features#71832.properties.OBJECTID AS OBJECTID#71856L, features#71832.properties.POP_2010 AS POP_2010#71857L, features#71832.properties.PUMA10 AS PUMA10#71858, features#71832.properties.SPA_2012 AS SPA_2012#71859L, features#71832.properties.SPA_NAME AS SPA_NAME#71860, features#71832.properties.SUP_DIST AS SUP_DIST#71861, features#71832.properties.SUP_LABEL AS SUP_LABEL#71862, features#71832.properties.ShapeSTArea AS ShapeSTArea#71863, features#71832.properties.ShapeSTLength AS ShapeSTLength#71864, ... 2 more fields]
   +- Filter ((((isnotnull(features#71832.properties.HOUSING10) AND isnotnull(features#71832.properties.POP_2010)) AND isnotnull(features#71832.properties.CITY)) AND (((features#71832.properties.HOUSING10 >= 0) AND (features#71832.properties.POP_2010 >= 0)) AND (features#71832.properties.CITY = Los Angeles))) AND isnotnull(features#71832.geometry))
      +- Generate explode(features#71824), [0], false, [features#71832]
         +- Project [features#71824]
            +- Filter ((size(features#71824, true) > 0) AND isnotnull(features#71824))
               +- Relation [crs#71823,features#71824,name#71825,type#71826] geojson

== Physical Plan ==
BroadcastIndexJoin geom#72199: geometry, RightSide, LeftSide, Inner, WITHIN ST_WITHIN(geom#72199, geometry#71835)
:- Project [DR_NO#72139, LAT#72165, LON#72166,  **org.apache.spark.sql.sedona_sql.expressions.ST_Point**   AS geom#72199]
:  +- Filter ((((isnotnull(LAT#72165) AND isnotnull(LON#72166)) AND NOT (cast(LAT#72165 as int) = 0)) AND NOT (cast(LON#72166 as int) = 0)) AND isnotnull( **org.apache.spark.sql.sedona_sql.expressions.ST_Point**  ))
:     +- FileScan csv [DR_NO#72139,LAT#72165,LON#72166] Batched: false, DataFilters: [isnotnull(LAT#72165), isnotnull(LON#72166), NOT (cast(LAT#72165 as int) = 0), NOT (cast(LON#7216..., Format: CSV, Location: InMemoryFileIndex(2 paths)[s3://initial-notebook-data-bucket-dblab-905418150721/CrimeData/Crime_D..., PartitionFilters: [], PushedFilters: [IsNotNull(LAT), IsNotNull(LON)], ReadSchema: struct<DR_NO:string,LAT:string,LON:string>
+- SpatialIndex geometry#71835: geometry, RTREE, false, false
   +- *(1) Project [features#71832.properties.BG10 AS BG10#71841, features#71832.properties.BG10FIP10 AS BG10FIP10#71842, features#71832.properties.BG12 AS BG12#71843, features#71832.properties.CB10 AS CB10#71844, features#71832.properties.CEN_FIP13 AS CEN_FIP13#71845, features#71832.properties.CITY AS CITY#71846, features#71832.properties.CITYCOM AS CITYCOM#71847, features#71832.properties.COMM AS COMM#71848, features#71832.properties.CT10 AS CT10#71849, features#71832.properties.CT12 AS CT12#71850, features#71832.properties.CTCB10 AS CTCB10#71851, features#71832.properties.HD_2012 AS HD_2012#71852L, features#71832.properties.HD_NAME AS HD_NAME#71853, features#71832.properties.HOUSING10 AS HOUSING10#71854L, features#71832.properties.LA_FIP10 AS LA_FIP10#71855, features#71832.properties.OBJECTID AS OBJECTID#71856L, features#71832.properties.POP_2010 AS POP_2010#71857L, features#71832.properties.PUMA10 AS PUMA10#71858, features#71832.properties.SPA_2012 AS SPA_2012#71859L, features#71832.properties.SPA_NAME AS SPA_NAME#71860, features#71832.properties.SUP_DIST AS SUP_DIST#71861, features#71832.properties.SUP_LABEL AS SUP_LABEL#71862, features#71832.properties.ShapeSTArea AS ShapeSTArea#71863, features#71832.properties.ShapeSTLength AS ShapeSTLength#71864, ... 2 more fields]
      +- *(1) Filter ((((isnotnull(features#71832.properties.HOUSING10) AND isnotnull(features#71832.properties.POP_2010)) AND isnotnull(features#71832.properties.CITY)) AND (((features#71832.properties.HOUSING10 >= 0) AND (features#71832.properties.POP_2010 >= 0)) AND (features#71832.properties.CITY = Los Angeles))) AND isnotnull(features#71832.geometry))
         +- *(1) Generate explode(features#71824), false, [features#71832]
            +- *(1) Filter ((size(features#71824, true) > 0) AND isnotnull(features#71824))
               +- FileScan geojson [features#71824] Batched: false, DataFilters: [(size(features#71824, true) > 0), isnotnull(features#71824)], Format: GEOJSON, Location: InMemoryFileIndex(1 paths)[s3://initial-notebook-data-bucket-dblab-905418150721/2010_Census_Block..., PartitionFilters: [], PushedFilters: [IsNotNull(features)], ReadSchema: struct<features:array<struct<geometry:binary,properties:struct<BG10:string,BG10FIP10:string,BG12:..."
