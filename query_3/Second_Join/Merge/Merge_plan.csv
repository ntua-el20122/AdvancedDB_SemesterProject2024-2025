Description,Details
Execution Plan,"== Parsed Logical Plan ==
Join Inner,  **org.apache.spark.sql.sedona_sql.expressions.ST_Within**
:- Project [DR_NO#72942, LAT#72968, LON#72969,  **org.apache.spark.sql.sedona_sql.expressions.ST_Point**   AS geom#73002]
:  +- Project [DR_NO#72942, LAT#72968, LON#72969]
:     +- Filter (NOT (cast(LAT#72968 as int) = 0) AND NOT (cast(LON#72969 as int) = 0))
:        +- Relation [DR_NO#72942,Date Rptd#72943,DATE OCC#72944,TIME OCC#72945,AREA #72946,AREA NAME#72947,Rpt Dist No#72948,Part 1-2#72949,Crm Cd#72950,Crm Cd Desc#72951,Mocodes#72952,Vict Age#72953,Vict Sex#72954,Vict Descent#72955,Premis Cd#72956,Premis Desc#72957,Weapon Used Cd#72958,Weapon Desc#72959,Status#72960,Status Desc#72961,Crm Cd 1#72962,Crm Cd 2#72963,Crm Cd 3#72964,Crm Cd 4#72965,... 4 more fields] csv
+- ResolvedHint (strategy=merge)
   +- Filter (((HOUSING10#72657L >= cast(0 as bigint)) AND (POP_2010#72660L >= cast(0 as bigint))) AND (CITY#72649 = Los Angeles))
      +- Project [properties#72639.BG10 AS BG10#72644, properties#72639.BG10FIP10 AS BG10FIP10#72645, properties#72639.BG12 AS BG12#72646, properties#72639.CB10 AS CB10#72647, properties#72639.CEN_FIP13 AS CEN_FIP13#72648, properties#72639.CITY AS CITY#72649, properties#72639.CITYCOM AS CITYCOM#72650, properties#72639.COMM AS COMM#72651, properties#72639.CT10 AS CT10#72652, properties#72639.CT12 AS CT12#72653, properties#72639.CTCB10 AS CTCB10#72654, properties#72639.HD_2012 AS HD_2012#72655L, properties#72639.HD_NAME AS HD_NAME#72656, properties#72639.HOUSING10 AS HOUSING10#72657L, properties#72639.LA_FIP10 AS LA_FIP10#72658, properties#72639.OBJECTID AS OBJECTID#72659L, properties#72639.POP_2010 AS POP_2010#72660L, properties#72639.PUMA10 AS PUMA10#72661, properties#72639.SPA_2012 AS SPA_2012#72662L, properties#72639.SPA_NAME AS SPA_NAME#72663, properties#72639.SUP_DIST AS SUP_DIST#72664, properties#72639.SUP_LABEL AS SUP_LABEL#72665, properties#72639.ShapeSTArea AS ShapeSTArea#72666, properties#72639.ShapeSTLength AS ShapeSTLength#72667, ... 2 more fields]
         +- Project [features#72635.geometry AS geometry#72638, features#72635.properties AS properties#72639, features#72635.type AS type#72640]
            +- Project [features#72635]
               +- Generate explode(features#72627), false, [features#72635]
                  +- Relation [crs#72626,features#72627,name#72628,type#72629] geojson

== Analyzed Logical Plan ==
DR_NO: string, LAT: string, LON: string, geom: geometry, BG10: string, BG10FIP10: string, BG12: string, CB10: string, CEN_FIP13: string, CITY: string, CITYCOM: string, COMM: string, CT10: string, CT12: string, CTCB10: string, HD_2012: bigint, HD_NAME: string, HOUSING10: bigint, LA_FIP10: string, OBJECTID: bigint, POP_2010: bigint, PUMA10: string, SPA_2012: bigint, SPA_NAME: string, ... 6 more fields
Join Inner,  **org.apache.spark.sql.sedona_sql.expressions.ST_Within**
:- Project [DR_NO#72942, LAT#72968, LON#72969,  **org.apache.spark.sql.sedona_sql.expressions.ST_Point**   AS geom#73002]
:  +- Project [DR_NO#72942, LAT#72968, LON#72969]
:     +- Filter (NOT (cast(LAT#72968 as int) = 0) AND NOT (cast(LON#72969 as int) = 0))
:        +- Relation [DR_NO#72942,Date Rptd#72943,DATE OCC#72944,TIME OCC#72945,AREA #72946,AREA NAME#72947,Rpt Dist No#72948,Part 1-2#72949,Crm Cd#72950,Crm Cd Desc#72951,Mocodes#72952,Vict Age#72953,Vict Sex#72954,Vict Descent#72955,Premis Cd#72956,Premis Desc#72957,Weapon Used Cd#72958,Weapon Desc#72959,Status#72960,Status Desc#72961,Crm Cd 1#72962,Crm Cd 2#72963,Crm Cd 3#72964,Crm Cd 4#72965,... 4 more fields] csv
+- ResolvedHint (strategy=merge)
   +- Filter (((HOUSING10#72657L >= cast(0 as bigint)) AND (POP_2010#72660L >= cast(0 as bigint))) AND (CITY#72649 = Los Angeles))
      +- Project [properties#72639.BG10 AS BG10#72644, properties#72639.BG10FIP10 AS BG10FIP10#72645, properties#72639.BG12 AS BG12#72646, properties#72639.CB10 AS CB10#72647, properties#72639.CEN_FIP13 AS CEN_FIP13#72648, properties#72639.CITY AS CITY#72649, properties#72639.CITYCOM AS CITYCOM#72650, properties#72639.COMM AS COMM#72651, properties#72639.CT10 AS CT10#72652, properties#72639.CT12 AS CT12#72653, properties#72639.CTCB10 AS CTCB10#72654, properties#72639.HD_2012 AS HD_2012#72655L, properties#72639.HD_NAME AS HD_NAME#72656, properties#72639.HOUSING10 AS HOUSING10#72657L, properties#72639.LA_FIP10 AS LA_FIP10#72658, properties#72639.OBJECTID AS OBJECTID#72659L, properties#72639.POP_2010 AS POP_2010#72660L, properties#72639.PUMA10 AS PUMA10#72661, properties#72639.SPA_2012 AS SPA_2012#72662L, properties#72639.SPA_NAME AS SPA_NAME#72663, properties#72639.SUP_DIST AS SUP_DIST#72664, properties#72639.SUP_LABEL AS SUP_LABEL#72665, properties#72639.ShapeSTArea AS ShapeSTArea#72666, properties#72639.ShapeSTLength AS ShapeSTLength#72667, ... 2 more fields]
         +- Project [features#72635.geometry AS geometry#72638, features#72635.properties AS properties#72639, features#72635.type AS type#72640]
            +- Project [features#72635]
               +- Generate explode(features#72627), false, [features#72635]
                  +- Relation [crs#72626,features#72627,name#72628,type#72629] geojson

== Optimized Logical Plan ==
Join Inner,  **org.apache.spark.sql.sedona_sql.expressions.ST_Within**  , rightHint=(strategy=merge)
:- Project [DR_NO#72942, LAT#72968, LON#72969,  **org.apache.spark.sql.sedona_sql.expressions.ST_Point**   AS geom#73002]
:  +- Filter (((isnotnull(LAT#72968) AND isnotnull(LON#72969)) AND (NOT (cast(LAT#72968 as int) = 0) AND NOT (cast(LON#72969 as int) = 0))) AND isnotnull( **org.apache.spark.sql.sedona_sql.expressions.ST_Point**  ))
:     +- Relation [DR_NO#72942,Date Rptd#72943,DATE OCC#72944,TIME OCC#72945,AREA #72946,AREA NAME#72947,Rpt Dist No#72948,Part 1-2#72949,Crm Cd#72950,Crm Cd Desc#72951,Mocodes#72952,Vict Age#72953,Vict Sex#72954,Vict Descent#72955,Premis Cd#72956,Premis Desc#72957,Weapon Used Cd#72958,Weapon Desc#72959,Status#72960,Status Desc#72961,Crm Cd 1#72962,Crm Cd 2#72963,Crm Cd 3#72964,Crm Cd 4#72965,... 4 more fields] csv
+- Project [features#72635.properties.BG10 AS BG10#72644, features#72635.properties.BG10FIP10 AS BG10FIP10#72645, features#72635.properties.BG12 AS BG12#72646, features#72635.properties.CB10 AS CB10#72647, features#72635.properties.CEN_FIP13 AS CEN_FIP13#72648, features#72635.properties.CITY AS CITY#72649, features#72635.properties.CITYCOM AS CITYCOM#72650, features#72635.properties.COMM AS COMM#72651, features#72635.properties.CT10 AS CT10#72652, features#72635.properties.CT12 AS CT12#72653, features#72635.properties.CTCB10 AS CTCB10#72654, features#72635.properties.HD_2012 AS HD_2012#72655L, features#72635.properties.HD_NAME AS HD_NAME#72656, features#72635.properties.HOUSING10 AS HOUSING10#72657L, features#72635.properties.LA_FIP10 AS LA_FIP10#72658, features#72635.properties.OBJECTID AS OBJECTID#72659L, features#72635.properties.POP_2010 AS POP_2010#72660L, features#72635.properties.PUMA10 AS PUMA10#72661, features#72635.properties.SPA_2012 AS SPA_2012#72662L, features#72635.properties.SPA_NAME AS SPA_NAME#72663, features#72635.properties.SUP_DIST AS SUP_DIST#72664, features#72635.properties.SUP_LABEL AS SUP_LABEL#72665, features#72635.properties.ShapeSTArea AS ShapeSTArea#72666, features#72635.properties.ShapeSTLength AS ShapeSTLength#72667, ... 2 more fields]
   +- Filter ((((isnotnull(features#72635.properties.HOUSING10) AND isnotnull(features#72635.properties.POP_2010)) AND isnotnull(features#72635.properties.CITY)) AND (((features#72635.properties.HOUSING10 >= 0) AND (features#72635.properties.POP_2010 >= 0)) AND (features#72635.properties.CITY = Los Angeles))) AND isnotnull(features#72635.geometry))
      +- Generate explode(features#72627), [0], false, [features#72635]
         +- Project [features#72627]
            +- Filter ((size(features#72627, true) > 0) AND isnotnull(features#72627))
               +- Relation [crs#72626,features#72627,name#72628,type#72629] geojson

== Physical Plan ==
RangeJoin geom#73002: geometry, geometry#72638: geometry, WITHIN
:- Project [DR_NO#72942, LAT#72968, LON#72969,  **org.apache.spark.sql.sedona_sql.expressions.ST_Point**   AS geom#73002]
:  +- Filter ((((isnotnull(LAT#72968) AND isnotnull(LON#72969)) AND NOT (cast(LAT#72968 as int) = 0)) AND NOT (cast(LON#72969 as int) = 0)) AND isnotnull( **org.apache.spark.sql.sedona_sql.expressions.ST_Point**  ))
:     +- FileScan csv [DR_NO#72942,LAT#72968,LON#72969] Batched: false, DataFilters: [isnotnull(LAT#72968), isnotnull(LON#72969), NOT (cast(LAT#72968 as int) = 0), NOT (cast(LON#7296..., Format: CSV, Location: InMemoryFileIndex(2 paths)[s3://initial-notebook-data-bucket-dblab-905418150721/CrimeData/Crime_D..., PartitionFilters: [], PushedFilters: [IsNotNull(LAT), IsNotNull(LON)], ReadSchema: struct<DR_NO:string,LAT:string,LON:string>
+- *(1) Project [features#72635.properties.BG10 AS BG10#72644, features#72635.properties.BG10FIP10 AS BG10FIP10#72645, features#72635.properties.BG12 AS BG12#72646, features#72635.properties.CB10 AS CB10#72647, features#72635.properties.CEN_FIP13 AS CEN_FIP13#72648, features#72635.properties.CITY AS CITY#72649, features#72635.properties.CITYCOM AS CITYCOM#72650, features#72635.properties.COMM AS COMM#72651, features#72635.properties.CT10 AS CT10#72652, features#72635.properties.CT12 AS CT12#72653, features#72635.properties.CTCB10 AS CTCB10#72654, features#72635.properties.HD_2012 AS HD_2012#72655L, features#72635.properties.HD_NAME AS HD_NAME#72656, features#72635.properties.HOUSING10 AS HOUSING10#72657L, features#72635.properties.LA_FIP10 AS LA_FIP10#72658, features#72635.properties.OBJECTID AS OBJECTID#72659L, features#72635.properties.POP_2010 AS POP_2010#72660L, features#72635.properties.PUMA10 AS PUMA10#72661, features#72635.properties.SPA_2012 AS SPA_2012#72662L, features#72635.properties.SPA_NAME AS SPA_NAME#72663, features#72635.properties.SUP_DIST AS SUP_DIST#72664, features#72635.properties.SUP_LABEL AS SUP_LABEL#72665, features#72635.properties.ShapeSTArea AS ShapeSTArea#72666, features#72635.properties.ShapeSTLength AS ShapeSTLength#72667, ... 2 more fields]
   +- *(1) Filter ((((isnotnull(features#72635.properties.HOUSING10) AND isnotnull(features#72635.properties.POP_2010)) AND isnotnull(features#72635.properties.CITY)) AND (((features#72635.properties.HOUSING10 >= 0) AND (features#72635.properties.POP_2010 >= 0)) AND (features#72635.properties.CITY = Los Angeles))) AND isnotnull(features#72635.geometry))
      +- *(1) Generate explode(features#72627), false, [features#72635]
         +- *(1) Filter ((size(features#72627, true) > 0) AND isnotnull(features#72627))
            +- FileScan geojson [features#72627] Batched: false, DataFilters: [(size(features#72627, true) > 0), isnotnull(features#72627)], Format: GEOJSON, Location: InMemoryFileIndex(1 paths)[s3://initial-notebook-data-bucket-dblab-905418150721/2010_Census_Block..., PartitionFilters: [], PushedFilters: [IsNotNull(features)], ReadSchema: struct<features:array<struct<geometry:binary,properties:struct<BG10:string,BG10FIP10:string,BG12:..."
